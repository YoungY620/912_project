# OS 2016 midterm sectum
## 一、判断
1）F 最终会被initproc回收
2）T
3）T 操作系统——精髓与设计原理，第八版P106
4）F
5）T
6）T
7）F 系统调用表
8）F 可以访问TLB
9）F
10）T

## 二、填空
### 11）
1）虚拟地址   2）线性地址  3）物理地址  4）虚拟地址  5）线性地址

### 12）
1）时间  2）空间

### 13）
1）运行  2）就绪  3）等待  4）就绪/等待  5）运行
6）睡眠  7）运行  8）退出  9）完全退出

### 14）
1）CPL  2）DPL  3）RPL
4）CPL  5）DPL  6）RPL
7）CPL  8）DPL  9）RPL  10）DPL

## 三、问答
### 15）
1）这个也考过太多遍了8
2）
```
a.[A=256][256][512]
b.[A=256][B=128][128][512]
c.[A=256][B=128][C=64][64][512]
d.[A=256][B=128][C=64][64][D=256][256]
e.[A=256][128][C=64][64][D=256][256]
f.[256][128][C=64][64][D=256][256]
g.[256][E=128][C=64][64][D=256][256]
h.[256][E=128][128][D=256][256]
i.[512][D=256][256]
j.[1024]
```
### 16）
1）缺页率置换算法属于全局置换算法。其工作原理是通过检测其在近一段时间内的缺页率，从而决定是否要给进程分配更多的物理页帧，即通过调节常驻集的大小使进程的缺页率保持在一个合理的范围内。实现办法是：

- 添加访问位标志，访问页面时置1
- 缺页时在替换操作完成后置访问位标志为0，再访问被换入的页，
- 缺页时计算从上次缺页到现在的时间间隔，如果大于参数，则置换此时间段内所有没有被引用过的页（没有符合的页则增加一个物理页帧）；如果小于等于参数，则增加一个物理页帧用于此进程

2）实例，5次缺页

| 序号     | 第0次访问 | 第1次访问 | 第2次访问 | 第3次访问 | 第4次访问 | 第5次访问 | 第6次访问 | 第7次访问 | 第8次访问 | 第9次访问 | 第10次访问 |
| -------- | --------- | --------- | --------- | --------- | --------- | --------- | --------- | --------- | --------- | --------- | ---------- |
| 访问序列 | 2         | 0         | 3         | 2         | 3         | 2         | 1         | 2         | 3         | 5         | 2          |
| 页面0    |           | 1 新增    | 0         | 0         | 0         | 0         | 被替换    |           |           |           |            |
| 页面1    |           |           |           |           |           |           | 1 替换    | 1         | 1         | 0         | 0          |
| 页面2    | 1 新增    | 0         | 0         | 1         | 1         | 1         | 0         | 1         | 1         | 0         | 1          |
| 页面3    |           |           | 1 新增    | 1         | 1         | 1         | 0         | 0         | 1         | 0         | 0          |
| 页面4    |           |           |           |           |           |           |           |           |           |           |            |
| 页面5    |           |           |           |           |           |           |           |           |           | 1 新增    | 1          |
| 缺页间隔 | 1         | 1         | 1         |           |           |           | 4         |           |           | 3         |            |
### 17）
1）

原理：

- 物理和虚拟内存都分成大小相同的页
- 物理页和虚拟页之间有相应的对照关系
- 以页为单位为进程分配内存。

优势：
- 保证了进程可以在执行过程中动态的申请内存，从而提高了利用率

- 可以非连续分配，从而提高利用率

- 可以方便的实现内存共享

2）
页面大小4KB，虚拟地址中页内偏移12位，一个页表项32位即4B故每个物理页可以存放1K个页表项/页目录项，故每级页表号10位，因此虚拟地址从高到低依次为10位一级页号，10位二级页号，12位页内偏移。
每个一级页号指向一个页目录项，页目录项中存放页表的物理地址，根据二级页号在页表中找到页表项，此页表项中存放虚拟地址对应的物理页面的首地址.jpg
3）

```c
0xC7384BAC = 1100011100|1110000100|101110101100
0x07141BAC = 0000011100|0101000001|101110101100
pde_idx = 1100011100 = 0x31C
pde_ctx = 0x31C-0x300+3|0000000000|11 = 0x0001F003
pte_idx = 1110000100 = 0x384
pte_ctx = 00000111000101000001|0000000000|11 = 0x07141003
```
```c
0xCAEDED27 = 1100101011|1011011110|110100100111
0x07919D27 = 0000011110|0100011001|110100100111
pde_idx = 1100101011 = 0x32B
pde_ctx = 0x32B-0x300+3|0000000000|11 = 0x0002E003
pte_idx = 1011011110 = 0x2DE
pte_ctx = 00000111100100011001|0000000000|11 = 0x07919003
```
